<mat-card class="form-card">
  <mat-card-header class="card-header">
    <mat-card-title class="card-title">
      {{ 'PRODUCTS.CREATE_TITLE' | translate }}
    </mat-card-title>
  </mat-card-header>
  
  <mat-card-content>
      <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
        <div class="form-row">
          <!-- SKU -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.SKU' | translate }}</mat-label>
            <input matInput formControlName="sku" maxlength="50">
            <mat-error>{{ getFieldError('sku') }}</mat-error>
          </mat-form-field>

          <!-- Name -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.NAME' | translate }}</mat-label>
            <input matInput formControlName="name" maxlength="200">
            <mat-error>{{ getFieldError('name') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Category -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.CATEGORY' | translate }}</mat-label>
            <mat-select formControlName="category">
              <mat-option *ngFor="let category of categories" [value]="category">
                {{ category }}
              </mat-option>
            </mat-select>
            <mat-error>{{ getFieldError('category') }}</mat-error>
          </mat-form-field>

          <!-- Subcategory -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.SUBCATEGORY' | translate }}</mat-label>
            <input matInput formControlName="subcategory" maxlength="100">
          </mat-form-field>
        </div>

        <!-- Description -->
        <mat-form-field appearance="outline" floatLabel="always" class="full-width">
          <mat-label>{{ 'PRODUCTS.DESCRIPTION' | translate }}</mat-label>
          <textarea matInput formControlName="description" rows="3" maxlength="1000"></textarea>
          <mat-hint align="end">{{ productForm.get('description')?.value?.length || 0 }}/1000</mat-hint>
        </mat-form-field>

        <div class="form-row">
          <!-- Unit Price -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.PRICE' | translate }}</mat-label>
            <input matInput type="number" step="0.01" formControlName="unit_price" min="0.01" max="999999999.99">
            <mat-error>{{ getFieldError('unit_price') }}</mat-error>
          </mat-form-field>

          <!-- Currency -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.CURRENCY' | translate }}</mat-label>
            <mat-select formControlName="currency">
              <mat-option *ngFor="let currency of currencies" [value]="currency">
                {{ currency }}
              </mat-option>
            </mat-select>
            <mat-error>{{ getFieldError('currency') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Unit of Measure -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.UNIT_OF_MEASURE' | translate }}</mat-label>
            <mat-select formControlName="unit_of_measure">
              <mat-option *ngFor="let unit of unitsOfMeasure" [value]="unit">
                {{ unit }}
              </mat-option>
            </mat-select>
            <mat-error>{{ getFieldError('unit_of_measure') }}</mat-error>
          </mat-form-field>

          <!-- Supplier ID -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field required">
            <mat-label>{{ 'PRODUCTS.SUPPLIER_ID' | translate }}</mat-label>
            <input matInput type="number" formControlName="supplier_id" min="1">
            <mat-error>{{ getFieldError('supplier_id') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Manufacturer -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.MANUFACTURER' | translate }}</mat-label>
            <input matInput formControlName="manufacturer" maxlength="200">
          </mat-form-field>

          <!-- Country of Origin -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.COUNTRY_ORIGIN' | translate }}</mat-label>
            <input matInput formControlName="country_of_origin" maxlength="100">
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Cold Chain -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.COLD_CHAIN' | translate }}</mat-label>
            <mat-select formControlName="requires_cold_chain">
              <mat-option [value]="false">{{ 'COMMON.NO' | translate }}</mat-option>
              <mat-option [value]="true">{{ 'COMMON.YES' | translate }}</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Barcode -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.BARCODE' | translate }}</mat-label>
            <input matInput formControlName="barcode" maxlength="50">
            <mat-error>{{ getFieldError('barcode') }}</mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <!-- Image URL -->
          <mat-form-field appearance="outline" floatLabel="always" class="form-field">
            <mat-label>{{ 'PRODUCTS.IMAGE_URL' | translate }}</mat-label>
            <input matInput formControlName="image_url" maxlength="500">
            <mat-error>{{ getFieldError('image_url') }}</mat-error>
          </mat-form-field>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button mat-raised-button color="primary" type="submit" [disabled]="loading()">
            @if (loading()) {
              <mat-spinner diameter="20"></mat-spinner>
            }
            {{ 'COMMON.SAVE' | translate }}
          </button>
          <button mat-raised-button type="button" (click)="onCancel()" [disabled]="loading()">
            {{ 'COMMON.CANCEL' | translate }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>